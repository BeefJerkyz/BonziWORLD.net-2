<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BonziTV</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    background: black;
  }
  #bonzitv {
    width: 100%;
    height: 100%;
    pointer-events: none;
  }

  .ytp-fullscreen-button {
    display: none !important;
  }
</style>
</head>
<body>
<div id="bonzitv"></div>

<script>
let player;
const introVideo = "BCouBFCB8QA"; 

// Separate arrays for shows and idents
const shows = [
  // Inanimate Insanity Season 2 episodes
  "xEOUmwUB_cE", "0tbpQ3jccbk", "nrzRpAZibVc", "l1-EsJtvm5w",
  "5loEcrE1IvQ", "dZft9ZHXWcE", "scwqoN66DU0", "omKX_3r4lxQ",
  "Q4QADdy6rK4", "0vh5szkAdkY", "ayHy91TVX1c", "-Nom7K4Rqi0",
  "WKvS5_h3dQs", "7etjFwAeKcA", "xSeVhTmLHHM",
  
  // BFDI episodes
  "YQa2-DY7Y_Q", "8LY0o_CgPR8", "JfzEO9-Zlhw", "rhkgOXksmaY",
  "xHI-iKm31us", "6vGgsXO57bs", "Ze1p7bYXw0g", "ylVsfdU5pxo"
];

const idents = [
  // Select just 1 ident to use
  "1KFVDDEaIEo"
];

let currentIdent = idents[0]; // Always use the same ident

function onYouTubeIframeAPIReady() {
  createPlayer(introVideo);
}

function createPlayer(videoId) {
  player = new YT.Player('bonzitv', {
    videoId: videoId,
    playerVars: {
      autoplay: 1,
      controls: 0,
      modestbranding: 1,
      rel: 0,
      fs: 0,
      showinfo: 0,
      disablekb: 1,
      playsinline: 1
    },
    events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange,
      'onError': onPlayerError
    }
  });
}

function onPlayerReady(event) {
  event.target.playVideo();
  enforcePlay();
  preventFullscreen();
  disableInteraction();
}

// Force video to keep playing
function onPlayerStateChange(event) {
  if (event.data === YT.PlayerState.ENDED) {
    // After any video ends, play the ident first
    setTimeout(() => {
      player.loadVideoById(currentIdent);
    }, 100);
  }
  if (event.data === YT.PlayerState.PAUSED) {
    player.playVideo();
  }
}

function playRandomShow() {
  let nextShow = shows[Math.floor(Math.random() * shows.length)];
  player.loadVideoById(nextShow);
}

function onPlayerError(event) {
  console.warn("Video unavailable, skipping to next video.");
  if (player.getVideoData().video_id === currentIdent) {
    // If ident fails, go straight to a show
    playRandomShow();
  } else {
    // If show fails, play the ident
    player.loadVideoById(currentIdent);
  }
}

function enforcePlay() {
  setInterval(() => {
    if (player && player.getPlayerState() !== YT.PlayerState.PLAYING) {
      player.playVideo();
    }
  }, 100);
}

function preventFullscreen() {
  const iframe = document.querySelector('#player iframe');
  if (iframe) iframe.setAttribute('allowfullscreen', 'false');
  document.addEventListener('keydown', e => {
    if (e.key === 'F11') e.preventDefault();
  });
  document.addEventListener('fullscreenchange', () => {
    if (document.fullscreenElement) document.exitFullscreen();
  });
}

function disableInteraction() {
  document.addEventListener('contextmenu', e => e.preventDefault());
  document.addEventListener('keydown', e => {
    const blockedKeys = [' ', 'ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown', 'k', 'j', 'l', 'f', 'm'];
    if (blockedKeys.includes(e.key)) e.preventDefault();
  });
}

// Override the playRandomVideo function to handle the ident->show transition
const originalPlayRandomVideo = window.playRandomVideo;
window.playRandomVideo = function() {
  // When ident ends, play a random show
  if (player && player.getVideoData().video_id === currentIdent) {
    playRandomShow();
  }
};
</script>

<script src="https://www.youtube.com/iframe_api"></script>
</body>
</html>
